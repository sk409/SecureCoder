{
    "index": 1,
    "fileName": "trap.php",
    "explainers": [
            {
                "questionIndices": [],
                "focusLabels": [],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "これが攻撃者が用意した罠サイトです。\nこれから先ほど脆弱性を作り込んだWebサイトに実際に攻撃するコードを書いて、攻撃者の手口を学習します。",
                        "languages": []
                    },
                    {
                        "text": "なお、実際にこれから書くようなコードを書いて実在するWebサイトを攻撃するようなことは絶対にしないでください。",
                        "languages": []
                    }
                ]
            },
            {
                "questionIndices": [],
                "focusLabels": [],
                "focusComponents": [
                    [0, 1, 2]
                ],
                "messages": [
                    {
                        "text": "赤枠で囲まれた<a>タグ内に脆弱なWebサイトにスクリプトを埋め込むためのコード記述していきます。",
                        "languages": ["html"]
                    },
                    {
                        "text": "以下がその<a>タグの内容です。\n<a href=\"http://www.unsafe.co.jp/welcome.php?name=\">",
                        "languages": ["html"]
                    },
                    {
                        "text": "先ほどの脆弱なWebサイトでGETリクエストで受け取った値をエスケープせずに直接表示していたため、このnameに設定された値がそのまま表示されます。\n攻撃者はここを狙って自身の用意したスクリプトを実行させようとします。",
                        "languages": []
                    },
                    {
                        "text": "それでは実際にスクリプトを埋め込むコードを記述していきます。\n今回はnameの値に直接スクリプトを書くと見づらくなってしまうため、別のファイルからスクリプトを読み込む処理を記述していきます。\n読み込むファイルはhttp://www.trap.co.jpにあるiframe_injection.jsです。",
                        "languages": []
                    }
                ]
            },
            {
                "questionIndices": [0],
                "focusLabels": [],
                "focusComponents": [
                    []
                ],
                "messages": [
                    {
                        "text": "スクリプトを埋め込むための処理が記述できました。\n次は実際に埋め込まれるスクリプトであるiframe_injection.jsを見ていきましょう。",
                        "languages": []
                    }
                ]
            }
        ]
}